Functional Alternative Splicing Events Score (FAScore)
================
chenli
2025/09/20

</br>

## What is FAScore?

FAScore is a machine learning framework designed to predict functionally
significant alternative splicing (AS) events during biological processes
such as hematopoietic differentiation. By integrating dynamic expression
patterns of AS events and their harboring genes with isoform-specific
sequence conservation and structural features, it computes functional
scores through Random Forest (RF) modeling. The framework further
classifies AS events into functional categories using a Gaussian Mixture
Model (GMM).

The analysis incorporates two feature classes:

Dynamic features: Expression breadth (*R*), tissue specificity (*τ*),
correlation (Spearman’s *ρ* with significance *P*<sub>*ρ*</sub>), and
expression trends (regression slope *β* with *P*<sub>*β*</sub>). These
are scaled (0 to 1) and combined into a DyScore (-1 to 1), where
positive/negative values indicate up-/down-regulation respectively.
Structural features: Derived from APPRIS, including evolutionary
conservation, functional domains, transmembrane helices, and subcellular
localization signatures.

FAScore outputs both DyScore (dynamic score) and FAScore (functional
score) for all annotated AS events. The package supports full analysis
in 11 species (human, macaque, chimpanzee, mouse, rat, pig, cow,
chicken, zebrafish, fruitfly and C. elegans) and DyScore calculation in
any species.


<div align="center">
<img width = '900' height ='320' src ="https://github.com/LuChenLab/FAScore/blob/master/figure/workflow.png"/>
</div>
<br>

## Contents

[Installation](#Installation)  
[Input](#Input)  
[Output](#Output)  
[Tutorial](#Tutorial)  
[SessionInfo](#SessionInfo)  
[Contact](#Contact)  
[Citation](#Citation)

## Installation

FAScore has been developed with `R 4.0.0` and the following packages are
needed to be installed in `R` (R scripts in FAScore automatically check
to see if an R library is already installed and then install those that
are needed. So no need for manual preinstallation!):

    randomForest (>= 4.0),
    SummarizedExperiment (>= 1.18),
    dplyr (>= 1.1),
    GenomicRanges (>= 1.43),
    GenomicFeatures (>= 1.43),
    ggplot2 (>= 3.5),
    ggrepel (>= 0.9),
    methods (>= 4.0),
    rtracklayer (>= 1.51),
    stringr (>= 1.5),
    tidyr (>= 1.3),
    IRanges (>= 2.25),
    stats (>= 4.0),
    reshape2 (>= 1.0),
    parallel (>= 4.0),
    S4Vectors (>= 0.26),
    cowplot (>= 1.1),
    mclust (>= 5.4)

To install FAScore, you have two options: either install directly from
GitHub or use the compressed source file:

``` r
# Install from GitHub if remotes package is not installed
if (!requireNamespace("remotes", quietly = TRUE))
    install.packages("remotes")

remotes::install_github("LuChenLab/FAScore/package")
```

Alternatively, you can install FAScore using the source file downloaded
from the repository :

``` bash
# Install FAScore from a downloaded source file
R CMD INSTALL FAScore_0.3.0.tar.gz
```

</br> </br>

## Input

#### PSI value of all AS events

A data frame where rows represent alternative splicing (AS) events or
splice junctions (SJs), columns correspond to sample identifiers, and
values are pre-computed percent spliced in (PSI) scores generated by
tools such as rMATS or ICAS.

#### Gene expression

A data frame containing normalized gene expression counts (e.g., TPM,
FPKM, or DESeq2-normalized counts) with gene identifiers as rows and
matching sample identifiers (consistent with the PSI data frame) as
columns.

#### Isoform expression

A data frame containing normalized transcript-level expression counts
(e.g., RSEM-derived TPM/FPKM values), where rows represent transcript
identifiers, columns correspond to sample identifiers (must match those
in the PSI data frame), and values contain the normalized isoform
expression measurements.

#### Gene annotation file (GTF file)

A file path pointing to a Gene Transfer Format (GTF) file containing
genome annotations for alternative splicing (AS) events, splice
junctions (SJs), isoforms, and gene loci. Species-specific GTF files are
available from the
[**Ensembl**](https://asia.ensembl.org/info/data/ftp/index.html)
database

#### Sample information

A data frame where rows represent sample identifiers (matching column
names in PSI, gene expression, and isoform expression matrices),
containing a required grouping variable with at least three distinct
biological classes, along with any additional sample metadata.

#### Isoform structural information (optional)

A data frame with structural-related scores such as cross-species
sequence conservation score (Conservation), the functionally important
residues score (AA.residues), domain integrity score (Domain.integrity),
the structural homologs and integrity score (Protein3D), trans-membrane
helices score (Transmembrane), signal peptide score (SignalP), and
subcellular location score (TargetP). Files for species beyond
**human**(GRCh38), **rhesus macaque**(Mmul10), **rat**(Rnor6.0),
**mouse**(GRCm38), and **zebrafish**(GRCz11) can be downloaded from the
[**APPRIS**](https://appris.bioinfo.cnio.es/#/) database. </br> </br>

## Output

The output will be an S4 object containing the following slots:

-   `assays` : A SimpleList of matrix-like objects, including the PSI
    matrix of AS events derived from the input.
-   `colData` : An optional DataFrame providing information on the
    samples, as specified in the input.
-   `rowRanges` : A GRanges object describing the ranges of AS events
    and corresponding gene and isoform IDs. It includes columns for
    **ASID**, **TranscriptID**, **GeneID**, **GeneName** and
    **matchTransID**. The **matchTransID** column stores the
    best-matching transcript for each gene based on maximum expression
    values (from `ISOFORM` data), aiding in mapping isoform structural
    information.
-   `GENE` : A data frame of gene expression values provided in the
    input.
-   `ISOFORM` : A data frame of isoform expression values provided in
    the input.
-   `Correlation` : A list containing the Spearman’s rank correlation
    coefficient (*ρ*) and corresponding p-value (*P*<sub>*ρ*<sub>) for
    genes or AS events.
-   `Tau` : A list containing the specificity index (*τ*) for genes and
    AS events, which quantifies the specificity of expression profiles.
    Higher values indicate greater specificity.
-   `Range` : A list containing range value (*R*) for genes and AS
    events, representing the breadth of expression.
-   `Linear` : A list containing linear fit parameters (intercept, slope
    (*β*), r<sup>2</sup>), and the p-value (*P*<sub>*β*</sub>) for the
    linear fit of genes and AS events, representing the expression
    gradient.
-   `DyScore` : A list capturing dynamic scores for genes and AS events.
-   `Structure` : A data frame of isoform structural scores obtained
    from the APPRIS database.
-   `RFpredict` : The predicted scores and classification results from
    the pre-trained model, stored in the **FAScore** and **FAStype**
    columns.
-   `GMM` : The parameter result of gaussian mixture model (GMM).

</br> </br>

## Tutorial

### Usage

For detailed usage of parameters of functions, please `help()` or `?`.

### Prepare

Loading example dataset (You can download from our **figshare**
database: <https://doi.org/10.6084/m9.figshare.29069336.v4>).

``` r
library(FAScore)
library(dplyr)
library(ggplot2)
```

``` r
df_AS <- read.table("MusMus_Erythroid_AS.txt", header = T, check.names = FALSE)
df_AS <- df_AS[apply(df_AS, 1, function(x) {sum(x >= 0.05 & x <= 0.95, na.rm = T) >= 2}), ]
df_Gene <- read.table("MusMus_Erythroid_Gene.txt", header = T, check.names = FALSE)
df_Iso <- read.table("MusMus_Erythroid_Iso.txt", header = T, check.names = FALSE)
```

``` r
head(df_AS)
```

    ##                         LT-HSC_1 LT-HSC_2  ST-HSC_1
    ## X:161255030-161255659:+ 0.396732 0.365764 0.2242840
    ## 6:17282083-17282684:+   0.135535 0.180492 0.0843074
    ## 4:120456285-120456509:+ 0.113175 0.375139 0.2064740
    ## 4:120462013-120462079:+ 0.602268 0.734503 0.5848140
    ## 4:120462080-120462155:+ 0.616394 0.761759 0.6365940
    ## 4:120463075-120463084:+ 0.922318 0.961764 0.9647620
    ##                          ST-HSC_2     MPP_1    MPP_2
    ## X:161255030-161255659:+ 0.4305620 0.4158790 0.477915
    ## 6:17282083-17282684:+   0.0553682 0.0630537 0.128031
    ## 4:120456285-120456509:+ 0.3071080 0.1488300 0.386593
    ## 4:120462013-120462079:+ 0.6001620 0.5240050 0.643911
    ## 4:120462080-120462155:+ 0.6578870 0.5595110 0.704905
    ## 4:120463075-120463084:+ 0.9496600 0.9711360 0.962019
    ##                            CMP_1    CMP_2    MEP_1
    ## X:161255030-161255659:+ 0.409742 0.439201 0.397258
    ## 6:17282083-17282684:+   0.168954 0.440274 0.000000
    ## 4:120456285-120456509:+ 0.143237 0.373457 0.205100
    ## 4:120462013-120462079:+ 0.554912 0.652065 0.607083
    ## 4:120462080-120462155:+ 0.650354 0.662815 0.621688
    ## 4:120463075-120463084:+ 0.946724 0.944725 0.947275
    ##                            MEP_2     MK_1     MK_2
    ## X:161255030-161255659:+ 0.378395 0.215838 0.479469
    ## 6:17282083-17282684:+   0.000000 0.103275 0.101225
    ## 4:120456285-120456509:+ 0.254499 0.218328 0.482626
    ## 4:120462013-120462079:+ 0.636477 0.687440 0.800307
    ## 4:120462080-120462155:+ 0.635275 0.663026 0.814104
    ## 4:120463075-120463084:+ 0.923054 0.954565 0.974340
    ##                           EryA_1    EryA_2   EryB_1
    ## X:161255030-161255659:+ 0.424259 0.5186920 0.390533
    ## 6:17282083-17282684:+   0.124026 0.0374126 0.000000
    ## 4:120456285-120456509:+ 0.348533 0.2273770 0.278966
    ## 4:120462013-120462079:+ 0.665422 0.6070830 0.661961
    ## 4:120462080-120462155:+ 0.721278 0.6774960 0.741367
    ## 4:120463075-120463084:+ 0.970910 0.9372700 1.000000
    ##                           EryB_2
    ## X:161255030-161255659:+ 0.657807
    ## 6:17282083-17282684:+   0.000000
    ## 4:120456285-120456509:+ 0.137418
    ## 4:120462013-120462079:+ 0.785945
    ## 4:120462080-120462155:+ 0.820738
    ## 4:120463075-120463084:+ 1.000000

``` r
head(df_Gene)
```

    ##                    LT-HSC_1 LT-HSC_2 ST-HSC_1 ST-HSC_2
    ## ENSMUSG00000000001    42.81    37.39    42.40    30.81
    ## ENSMUSG00000000003     0.00     0.00     0.00     0.00
    ## ENSMUSG00000000028    14.89     6.48    15.21     9.79
    ## ENSMUSG00000000031     0.88     0.45     0.09     0.40
    ## ENSMUSG00000000037     1.06     1.87     1.33     2.79
    ## ENSMUSG00000000049     0.00     0.00     0.00     0.00
    ##                    MPP_1 MPP_2 CMP_1 CMP_2 MEP_1 MEP_2
    ## ENSMUSG00000000001 28.19 26.35 31.50 18.98 23.66 14.39
    ## ENSMUSG00000000003  0.00  0.00  0.00  0.00  0.00  0.00
    ## ENSMUSG00000000028  9.74  9.74 10.19  8.01 13.28  9.99
    ## ENSMUSG00000000031  0.02  0.99  0.11  0.10  0.03  0.00
    ## ENSMUSG00000000037  1.16  1.81  0.93  0.93  2.03  2.00
    ## ENSMUSG00000000049  0.00  0.00  0.00  0.00  0.00  0.00
    ##                     MK_1  MK_2 EryA_1 EryA_2 EryB_1
    ## ENSMUSG00000000001 28.02 31.39  15.55  19.40   3.62
    ## ENSMUSG00000000003  0.00  0.00   0.00   0.00   0.00
    ## ENSMUSG00000000028  6.65  6.33  14.69  20.53   6.00
    ## ENSMUSG00000000031  0.01  0.02   0.01   0.01   0.00
    ## ENSMUSG00000000037  0.21  0.48   0.77   0.91   0.14
    ## ENSMUSG00000000049  0.00  0.02   0.00   0.00   0.00
    ##                    EryB_2
    ## ENSMUSG00000000001   3.29
    ## ENSMUSG00000000003   0.00
    ## ENSMUSG00000000028   4.83
    ## ENSMUSG00000000031   0.00
    ## ENSMUSG00000000037   0.10
    ## ENSMUSG00000000049   0.00

``` r
head(df_Iso)
```

    ##                               gene_id LT-HSC_1 LT-HSC_2
    ## ENSMUST00000000001 ENSMUSG00000000001    42.81    37.39
    ## ENSMUST00000000003 ENSMUSG00000000003     0.00     0.00
    ## ENSMUST00000000010 ENSMUSG00000020875     0.07     0.06
    ## ENSMUST00000000028 ENSMUSG00000000028    13.02     5.13
    ## ENSMUST00000000033 ENSMUSG00000048583     0.30     0.12
    ## ENSMUST00000000049 ENSMUSG00000000049     0.00     0.00
    ##                    ST-HSC_1 ST-HSC_2 MPP_1 MPP_2 CMP_1
    ## ENSMUST00000000001    42.40    30.81 28.19 26.35 31.50
    ## ENSMUST00000000003     0.00     0.00  0.00  0.00  0.00
    ## ENSMUST00000000010     0.00     0.00  0.00  0.00  0.00
    ## ENSMUST00000000028    13.30     8.03  8.63  8.49  9.04
    ## ENSMUST00000000033     0.01     0.05  0.00  0.00  0.03
    ## ENSMUST00000000049     0.00     0.00  0.00  0.00  0.00
    ##                    CMP_2 MEP_1 MEP_2  MK_1  MK_2 EryA_1
    ## ENSMUST00000000001 18.98 23.66 14.39 28.02 31.39  15.55
    ## ENSMUST00000000003  0.00  0.00  0.00  0.00  0.00   0.00
    ## ENSMUST00000000010  0.00  0.00  0.00  0.00  0.00   0.00
    ## ENSMUST00000000028  6.51 11.44  7.85  4.78  4.20  11.57
    ## ENSMUST00000000033  0.01  0.00  0.00  0.00  0.02   0.00
    ## ENSMUST00000000049  0.00  0.00  0.00  0.00  0.02   0.00
    ##                    EryA_2 EryB_1 EryB_2
    ## ENSMUST00000000001  19.40   3.62   3.29
    ## ENSMUST00000000003   0.00   0.00   0.00
    ## ENSMUST00000000010   0.00   0.00   0.00
    ## ENSMUST00000000028  16.06   4.26   3.44
    ## ENSMUST00000000033   0.00   0.00   0.00
    ## ENSMUST00000000049   0.00   0.00   0.00

``` r
data(ExDataSet)
head(ExDataSet$meta)
```

    ##               Run CellType    Lineage
    ## LT-HSC_1 LT-HSC_1   LT-HSC       Stem
    ## LT-HSC_2 LT-HSC_2   LT-HSC       Stem
    ## ST-HSC_1 ST-HSC_1   ST-HSC       Stem
    ## ST-HSC_2 ST-HSC_2   ST-HSC       Stem
    ## MPP_1       MPP_1      MPP Progenitor
    ## MPP_2       MPP_2      MPP Progenitor

</br>

### Creating a FAScore object

The alternative splicing PSI matrix, gene expression matrix, transcripts
expression matrix, and sample information table need to be prepared to
create a FAScore object.

``` r
MyObj <- FAScoreDataSet(colData = ExDataSet$meta, AS = df_AS, 
                        GENE = df_Gene, ISOFORM = df_Iso)
```

``` r
MyObj
```

    ## class: FAScore 
    ## dim: 22885 16 
    ## metadata(1): version
    ## assays(1): AS
    ## rownames(22885): X:161255030-161255659:+
    ##   6:17282083-17282684:+ ...
    ##   16:92076720-92087473:+ 16:91676808-91676923:-
    ## rowData names(0):
    ## colnames(16): LT-HSC_1 LT-HSC_2 ... EryB_1 EryB_2
    ## colData names(3): Run CellType Lineage

</br>

### Calculate the dynamic scores of AS events and genes

The dynamic score of genes or AS events is computed as the mean of
scaled (0-1) dynamic features from `CalcuFeature`, including:
R<sub>scaled</sub> (scaled TPM/PSI range), *τ* (specificity index,
0-1), *ρ* (Spearman’s correlation) with binarized *P*<sub>*ρ*</sub>, and
*β* (linear slope, -1 to 1) with binarized *P*<sub>*β*</sub>. The final
score ranges from -1 to 1, where absolute values represent effect size
(0-1) and signs indicate directionality (*β*). This calculation is
performed by the `CalcuDyScore` function. </br>

Preprocessing the related dynamic features

``` r
MyObj <- CalcuFeature(MyObj, group.by = "CellType", cores = 10)
```

``` r
head(MyObj@Correlation$Gene)  # head(MyObj@Correlation$AS)
```

    ##                    Spearman.cor   Spearman.p
    ## ENSMUSG00000000001   -0.7929133 0.0002483022
    ## ENSMUSG00000000003           NA           NA
    ## ENSMUSG00000000028   -0.2842377 0.2860039065
    ## ENSMUSG00000000031   -0.8488461 0.0000321010
    ## ENSMUSG00000000037   -0.7224375 0.0015723392
    ## ENSMUSG00000000049    0.1690309 0.5314416160

``` r
head(MyObj@Tau$Gene)  # head(MyObj@Tau$AS)
```

    ## ENSMUSG00000000001 ENSMUSG00000000003 
    ##          0.1925529          0.0000000 
    ## ENSMUSG00000000028 ENSMUSG00000000031 
    ##          0.2125353          0.7992165 
    ## ENSMUSG00000000037 ENSMUSG00000000049 
    ##          0.4109685          1.0000000

``` r
head(MyObj@Range$Gene)  # head(MyObj@Range$AS)
```

    ## ENSMUSG00000000001 ENSMUSG00000000003 
    ##         3.20348823         0.00000000 
    ## ENSMUSG00000000028 ENSMUSG00000000031 
    ##         1.52459953         0.72339278 
    ## ENSMUSG00000000037 ENSMUSG00000000049 
    ##         1.42887147         0.01428458

``` r
head(MyObj@Linear$Gene)  # head(MyObj@Linear$AS)
```

    ##                        intercept         slope
    ## ENSMUSG00000000001  5.3337205283 -0.0976133660
    ## ENSMUSG00000000003  0.0000000000  0.0000000000
    ## ENSMUSG00000000028  3.5319974802 -0.0125605032
    ## ENSMUSG00000000031  0.5115547613 -0.0326712188
    ## ENSMUSG00000000037  1.4298385411 -0.0455808804
    ## ENSMUSG00000000049 -0.0004310001  0.0002462858
    ##                            r2      pvalue
    ## ENSMUSG00000000001 0.44054084 0.005054309
    ## ENSMUSG00000000003        NaN         NaN
    ## ENSMUSG00000000028 0.02621270 0.549136371
    ## ENSMUSG00000000031 0.45241263 0.004304452
    ## ENSMUSG00000000037 0.33808048 0.018155151
    ## ENSMUSG00000000049 0.05517241 0.381202376

</br>

Calculating the dynamic scores

``` r
MyObj <- CalcuDyScore(MyObj, maxSlope = 1, type = "Gene")
MyObj <- CalcuDyScore(MyObj, maxSlope = 1, type = "AS")
```

``` r
head(MyObj@DyScore$Gene)
```

    ## ENSMUSG00000000001 ENSMUSG00000000003 
    ##         -0.6805133                 NA 
    ## ENSMUSG00000000028 ENSMUSG00000000031 
    ##         -0.2515556         -0.7340211 
    ## ENSMUSG00000000037 ENSMUSG00000000049 
    ##         -0.6964978          0.1972603

``` r
head(MyObj@DyScore$AS)
```

    ## X:161255030-161255659:+   6:17282083-17282684:+ 
    ##              0.12973496             -0.43323441 
    ## 4:120456285-120456509:+ 4:120462013-120462079:+ 
    ##              0.07340320              0.13429497 
    ## 4:120462080-120462155:+ 4:120463075-120463084:+ 
    ##              0.30033876              0.08212004

</br>

### Calculate the functional scores of AS events

The framework integrates dynamic, evolutionary conserved, and structural
features to train a predictive model using randomForest (provided as a
pre-trained model). Functional scores and classifications are generated
via the `CalcuFAScore` function, which supports both the pre-trained
model and user-customized models.

</br>

Adding gene and transcript information of AS events. Note: Processing
time may increase significantly with larger FAScore object dimensions.

``` r
my_gtf <- "Mus_musculus.GRCm38.101.gtf"
# or using other gtf files


MyObj <- ASmapIso(MyObj, gtf = my_gtf, AStype = "exonic", cores = 10)
MyObj <- ChooseIso(MyObj)
```

</br>

Adding the structural scores of transcripts

``` r
MyObj <- matchAppris(MyObj, gtf = my_gtf, species = "MusMus")
```

</br>

or other species and annotation versions downloaded from
[**APPRIS**](https://appris.bioinfo.cnio.es/#/) database

``` r
MyObj <- matchAppris(MyObj, gtf = my_gtf, appris = OtherFile)

head(MyObj@Structure)
```

</br>

Calculating the functional scores and classes

``` r
premodel = readRDS("finalModel.Rds")
MyObj <- CalcuFAScore(MyObj, model = premodel)

# Sorted by FAScore
MyObj@RFpredict <- MyObj@RFpredict[order(MyObj@RFpredict$FAScore,decreasing = T),]
```

</br>

Classify the AS by GMM

``` r
MyObj <- calcuGMM(MyObj)
```

    ## fitting ...
    ##   |                                                      |                                              |   0%  |                                                      |=======================                       |  50%  |                                                      |==============================================| 100%

``` r
head(MyObj@RFpredict)
```

    ##                        ASID
    ## 18      X:7762695-7763060:+
    ## 27      X:7767893-7767997:+
    ## 93   18:24205959-24206080:+
    ## 102 6:115675689-115675964:-
    ## 117  11:60240570-60240936:-
    ## 118  11:60240937-60241345:-
    ##                                                                                                                                                TranscriptID
    ## 18                                        ENSMUST00000077680,ENSMUST00000079542,ENSMUST00000115679,ENSMUST00000137467,ENSMUST00000143680,ENSMUST00000115680
    ## 27  ENSMUST00000077680,ENSMUST00000115679,ENSMUST00000137467,ENSMUST00000143680,ENSMUST00000115680,ENSMUST00000115677,ENSMUST00000101695,ENSMUST00000126694
    ## 93                                                                                                                    ENSMUST00000170243,ENSMUST00000164998
    ## 102                                                                                                                                      ENSMUST00000112949
    ## 117                                                                                                                                      ENSMUST00000064019
    ## 118                                                                                                                   ENSMUST00000064019,ENSMUST00000102682
    ##                                                              TranscriptName
    ## 18                    Tfe3-201,Tfe3-202,Tfe3-206,Tfe3-211,Tfe3-212,Tfe3-207
    ## 27  Tfe3-201,Tfe3-206,Tfe3-211,Tfe3-212,Tfe3-207,Tfe3-204,Tfe3-203,Tfe3-208
    ## 93                                                    Galnt1-206,Galnt1-203
    ## 102                                                                Raf1-202
    ## 117                                                              Tom1l2-201
    ## 118                                                   Tom1l2-201,Tom1l2-205
    ##                 GeneID GeneName       matchTransID
    ## 18  ENSMUSG00000000134     Tfe3 ENSMUST00000077680
    ## 27  ENSMUSG00000000134     Tfe3 ENSMUST00000077680
    ## 93  ENSMUSG00000000420   Galnt1 ENSMUST00000170243
    ## 102 ENSMUSG00000000441     Raf1 ENSMUST00000112949
    ## 117 ENSMUSG00000000538   Tom1l2 ENSMUST00000064019
    ## 118 ENSMUSG00000000538   Tom1l2 ENSMUST00000102682
    ##            matchGeneID Firestar Matador3D CORSAIR SPADE
    ## 18  ENSMUSG00000000134        0     2.250     7.2 311.6
    ## 27  ENSMUSG00000000134        0     2.250     7.2 311.6
    ## 93  ENSMUSG00000000420       23    12.250    18.1 234.0
    ## 102 ENSMUSG00000000441       18    12.008    13.4 356.4
    ## 117 ENSMUSG00000000538        0     6.200     0.0 251.1
    ## 118 ENSMUSG00000000538        0     6.200     0.0 251.1
    ##     THUMP SignalP TargetP AS.Spearman.cor AS.Spearman.p
    ## 18      0      -4      -5      -0.6390644             1
    ## 27      0      -4      -5      -0.8047478             1
    ## 93      3      -1      -5       0.7633270             1
    ## 102     0      -4      -5       0.6035609             1
    ## 117     0      -4      -5       0.6331472             1
    ## 118     0      -4      -5       0.6745680             1
    ##         AS.Tau  AS.Range     AS.Slope AS.Fit.p
    ## 18  0.03831619 0.1037665 -0.004392621        1
    ## 27  0.05476454 0.0861585 -0.003291382        1
    ## 93  0.06479391 0.1014530  0.004204700        1
    ## 102 0.57567747 0.3539160  0.012118099        1
    ## 117 0.50129677 0.3996310  0.015102335        1
    ## 118 0.44797153 0.3885665  0.015223646        1
    ##      ASDyScore Gene.Spearman.cor Gene.Spearman.p
    ## 18  -0.4642566        -0.1361972               0
    ## 27  -0.4914937        -0.1361972               0
    ## 93   0.4889631        -0.1479316               0
    ## 102  0.5908787        -0.5029674               1
    ## 117  0.5915295        -0.8698377               1
    ## 118  0.5877216        -0.8698377               1
    ##       Gene.Tau Gene.Range  Gene.Slope Gene.Fit.p
    ## 18  0.21975519   1.200320  0.01108142          0
    ## 27  0.21975519   1.200320  0.01108142          0
    ## 93  0.05473359   0.947713 -0.01502795          0
    ## 102 0.17934681   2.401096 -0.04339802          0
    ## 117 0.38613949   2.214737 -0.09362355          1
    ## 118 0.38613949   2.214737 -0.09362355          1
    ##      GeDyScore FAScore FASType
    ## 18   0.2278390       1    Func
    ## 27   0.2278390       1    Func
    ## 93  -0.1942344       1    Func
    ## 102 -0.4542854       1    Func
    ## 117 -0.7249335       1    Func
    ## 118 -0.7249335       1    Func

or visualization GMM

``` r
calcuGMM(MyObj, silent =T, main="Mouse")
```

<div align="left">
<img width = '350' height ='300' src ="https://github.com/LuChenLab/FAScore/blob/master/figure/GMM.png"/>
</div>

</br>
</br>

## SessionInfo

``` r
sessionInfo()
```

    ## R version 4.1.2 (2021-11-01)
    ## Platform: x86_64-pc-linux-gnu (64-bit)
    ## Running under: Ubuntu 18.04.6 LTS
    ## 
    ## Matrix products: default
    ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas/libblas.so.3
    ## LAPACK: /usr/lib/x86_64-linux-gnu/libopenblasp-r0.2.20.so
    ## 
    ## locale:
    ##  [1] LC_CTYPE=en_US.UTF-8      
    ##  [2] LC_NUMERIC=C              
    ##  [3] LC_TIME=en_US.UTF-8       
    ##  [4] LC_COLLATE=en_US.UTF-8    
    ##  [5] LC_MONETARY=en_US.UTF-8   
    ##  [6] LC_MESSAGES=en_US.UTF-8   
    ##  [7] LC_PAPER=en_US.UTF-8      
    ##  [8] LC_NAME=C                 
    ##  [9] LC_ADDRESS=C              
    ## [10] LC_TELEPHONE=C            
    ## [11] LC_MEASUREMENT=en_US.UTF-8
    ## [12] LC_IDENTIFICATION=C       
    ## 
    ## attached base packages:
    ## [1] stats     graphics  grDevices utils     datasets 
    ## [6] methods   base     
    ## 
    ## other attached packages:
    ## [1] rmarkdown_2.9 ggplot2_3.5.1 dplyr_1.1.4  
    ## [4] FAScore_0.3.0
    ## 
    ## loaded via a namespace (and not attached):
    ##   [1] utf8_1.2.2                 
    ##   [2] tidyselect_1.2.0           
    ##   [3] RSQLite_2.2.7              
    ##   [4] AnnotationDbi_1.53.1       
    ##   [5] htmlwidgets_1.5.3          
    ##   [6] grid_4.1.2                 
    ##   [7] BiocParallel_1.25.5        
    ##   [8] scatterpie_0.1.6           
    ##   [9] munsell_0.5.0              
    ##  [10] miniUI_0.1.1.1             
    ##  [11] withr_2.5.0                
    ##  [12] colorspace_2.0-2           
    ##  [13] GOSemSim_2.17.1            
    ##  [14] energy_1.7-8               
    ##  [15] filelock_1.0.2             
    ##  [16] Biobase_2.51.0             
    ##  [17] knitr_1.33                 
    ##  [18] rstudioapi_0.13            
    ##  [19] stats4_4.1.2               
    ##  [20] ggsignif_0.6.4             
    ##  [21] DOSE_3.17.0                
    ##  [22] labeling_0.4.2             
    ##  [23] MatrixGenerics_1.3.1       
    ##  [24] GenomeInfoDbData_1.2.4     
    ##  [25] polyclip_1.10-0            
    ##  [26] bit64_4.0.5                
    ##  [27] farver_2.1.0               
    ##  [28] downloader_0.4             
    ##  [29] vctrs_0.6.4                
    ##  [30] treeio_1.15.6              
    ##  [31] generics_0.1.0             
    ##  [32] xfun_0.24                  
    ##  [33] ggthemes_4.2.4             
    ##  [34] BiocFileCache_1.99.3       
    ##  [35] randomForest_4.6-14        
    ##  [36] R6_2.5.0                   
    ##  [37] GenomeInfoDb_1.27.11       
    ##  [38] graphlayouts_0.7.1         
    ##  [39] bitops_1.0-7               
    ##  [40] cachem_1.0.5               
    ##  [41] fgsea_1.17.0               
    ##  [42] DelayedArray_0.17.10       
    ##  [43] assertthat_0.2.1           
    ##  [44] promises_1.2.0.1           
    ##  [45] BiocIO_1.1.2               
    ##  [46] scales_1.3.0               
    ##  [47] ggraph_2.0.5               
    ##  [48] nnet_7.3-16                
    ##  [49] enrichplot_1.11.2          
    ##  [50] ggExtra_0.10.1             
    ##  [51] gtable_0.3.0               
    ##  [52] tidygraph_1.2.0            
    ##  [53] rlang_1.1.2                
    ##  [54] splines_4.1.2              
    ##  [55] rtracklayer_1.51.5         
    ##  [56] rstatix_0.7.0              
    ##  [57] lazyeval_0.2.2             
    ##  [58] broom_0.7.9                
    ##  [59] checkmate_2.0.0            
    ##  [60] BiocManager_1.30.22        
    ##  [61] yaml_2.2.1                 
    ##  [62] reshape2_1.4.4             
    ##  [63] abind_1.4-5                
    ##  [64] GenomicFeatures_1.43.8     
    ##  [65] backports_1.2.1            
    ##  [66] httpuv_1.6.1               
    ##  [67] qvalue_2.23.0              
    ##  [68] Hmisc_4.5-0                
    ##  [69] clusterProfiler_3.99.1     
    ##  [70] tools_4.1.2                
    ##  [71] ellipsis_0.3.2             
    ##  [72] RColorBrewer_1.1-2         
    ##  [73] BiocGenerics_0.37.1        
    ##  [74] Rcpp_1.0.12                
    ##  [75] plyr_1.8.6                 
    ##  [76] progress_1.2.2             
    ##  [77] base64enc_0.1-3            
    ##  [78] zlibbioc_1.37.0            
    ##  [79] purrr_1.0.2                
    ##  [80] RCurl_1.98-1.3             
    ##  [81] prettyunits_1.1.1          
    ##  [82] ggpubr_0.4.0               
    ##  [83] rpart_4.1-15               
    ##  [84] viridis_0.6.1              
    ##  [85] cowplot_1.1.1              
    ##  [86] S4Vectors_0.29.15          
    ##  [87] SummarizedExperiment_1.21.3
    ##  [88] haven_2.4.1                
    ##  [89] ggrepel_0.9.4              
    ##  [90] cluster_2.1.2              
    ##  [91] fs_1.5.0                   
    ##  [92] magrittr_2.0.1             
    ##  [93] data.table_1.14.0          
    ##  [94] DO.db_2.9                  
    ##  [95] openxlsx_4.2.4             
    ##  [96] matrixStats_0.62.0         
    ##  [97] gsl_2.1-6                  
    ##  [98] hms_1.1.0                  
    ##  [99] patchwork_1.1.1            
    ## [100] mime_0.11                  
    ## [101] evaluate_0.14              
    ## [102] xtable_1.8-4               
    ## [103] XML_3.99-0.6               
    ## [104] rio_0.5.27                 
    ## [105] jpeg_0.1-9                 
    ## [106] mclust_5.4.9               
    ## [107] readxl_1.3.1               
    ## [108] IRanges_2.25.7             
    ## [109] gridExtra_2.3              
    ## [110] biomaRt_2.47.7             
    ## [111] compiler_4.1.2             
    ## [112] tibble_3.2.1               
    ## [113] crayon_1.4.1               
    ## [114] shadowtext_0.0.8           
    ## [115] htmltools_0.5.1.1          
    ## [116] mgcv_1.8-38                
    ## [117] segmented_1.3-4            
    ## [118] ggfun_0.1.3                
    ## [119] later_1.2.0                
    ## [120] Formula_1.2-4              
    ## [121] tidyr_1.3.0                
    ## [122] aplot_0.0.6                
    ## [123] DBI_1.1.1                  
    ## [124] tweenr_1.0.2               
    ## [125] dbplyr_2.1.1               
    ## [126] rappdirs_0.3.3             
    ## [127] MASS_7.3-54                
    ## [128] boot_1.3-28                
    ## [129] Matrix_1.6-0               
    ## [130] car_3.0-11                 
    ## [131] cli_3.6.1                  
    ## [132] parallel_4.1.2             
    ## [133] igraph_1.2.6               
    ## [134] GenomicRanges_1.43.4       
    ## [135] forcats_0.5.1              
    ## [136] pkgconfig_2.0.3            
    ## [137] rvcheck_0.1.8              
    ## [138] GenomicAlignments_1.27.2   
    ## [139] foreign_0.8-81             
    ## [140] ggtree_3.10.0              
    ## [141] XVector_0.31.1             
    ## [142] yulab.utils_0.1.1          
    ## [143] stringr_1.5.1              
    ## [144] digest_0.6.27              
    ## [145] Biostrings_2.59.2          
    ## [146] cellranger_1.1.0           
    ## [147] fastmatch_1.1-3            
    ## [148] tidytree_0.4.6             
    ## [149] htmlTable_2.2.1            
    ## [150] restfulr_0.0.13            
    ## [151] curl_4.3.2                 
    ## [152] kernlab_0.9-29             
    ## [153] shiny_1.6.0                
    ## [154] Rsamtools_2.7.2            
    ## [155] rjson_0.2.20               
    ## [156] lifecycle_1.0.3            
    ## [157] nlme_3.1-152               
    ## [158] jsonlite_1.7.2             
    ## [159] carData_3.0-4              
    ## [160] viridisLite_0.4.0          
    ## [161] fansi_0.5.0                
    ## [162] pillar_1.9.0               
    ## [163] lattice_0.20-45            
    ## [164] KEGGREST_1.31.1            
    ## [165] fastmap_1.1.0              
    ## [166] httr_1.4.2                 
    ## [167] survival_3.2-13            
    ## [168] GO.db_3.12.1               
    ## [169] glue_1.6.2                 
    ## [170] zip_2.2.0                  
    ## [171] png_0.1-7                  
    ## [172] bit_4.0.4                  
    ## [173] ggforce_0.3.3              
    ## [174] stringi_1.7.3              
    ## [175] mixtools_1.2.0             
    ## [176] blob_1.2.2                 
    ## [177] latticeExtra_0.6-29        
    ## [178] memoise_2.0.0              
    ## [179] ggunchained_0.0.1          
    ## [180] ape_5.5

</br>  
</br> </br>

## Contact

Please contact Lu Chen (<luchen@scu.edu.cn>) or Li Chen
(<chenli5679@163.com>).

</br>

## Citation

If you use FAScore in your publication, please cite FAScore by
